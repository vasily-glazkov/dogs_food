{"ast":null,"code":"var _jsxFileName = \"/home/hercule/Documents/Courses/sber_university/projects/dogs_food/src/components/App/app.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport CardList from \"../CardList/card-list\";\nimport Footer from \"../Footer/footer\";\nimport Header from \"../Header/header\";\nimport Logo from \"../Logo/logo\";\nimport Search from \"../Search/search\";\nimport Sort from \"../Sort/sort\";\nimport \"./index.css\";\nimport SearchInfo from \"../SearchInfo\";\nimport api from \"../../utils/api\";\nimport useDebounce from \"../../hooks/useDebounce\";\nimport { isLiked } from \"../../utils/product\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  // устанавливаем состояния для карточек, поискового запроса\n  // и для пользователя\n  const [cards, setCards] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [currentUser, setCurrentUser] = useState(null);\n\n  // debounced версия поискового запроса\n  const debounceSearchQuery = useDebounce(searchQuery, 300);\n\n  // функция для совершения поисковых запросов с API для\n  // поиска продуктов\n  const handleRequest = () => {\n    api.search(debounceSearchQuery).then(searchResult => {\n      // обновляем карточки по результатам запроса\n      setCards(searchResult);\n    }).catch(err => console.log(err));\n  };\n\n  // Используем useEffect хук для загрузки списка продуктов и\n  // данных пользователя при загрузке компонента\n  useEffect(() => {\n    Promise.all([api.getProductList(), api.getUserInfo()]).then(_ref => {\n      let [productsData, userData] = _ref;\n      // обновляем состояние currentUser & cards\n      setCurrentUser(userData);\n      setCards(productsData.products);\n    }).catch(err => console.log(err));\n  }, []);\n\n  // Используем useEffect хук для вызова handleRequest при изменении\n  // поля поиска\n  useEffect(() => {\n    handleRequest();\n  }, [debounceSearchQuery]);\n  const handleFormSubmit = e => {\n    e.preventDefault();\n    handleRequest();\n  };\n  const handleInputChange = inputValue => {\n    setSearchQuery(inputValue);\n  };\n  function handleUpdateUser(userUpdateData) {\n    api.setUserInfo(userUpdateData).then(newUserData => {\n      setCurrentUser(newUserData);\n    });\n  }\n  function handleProductLike(product) {\n    const liked = isLiked(product.likes, currentUser._id);\n    api.changeLikeProduct(product._id, liked).then(newCard => {\n      const newProducts = cards.map(cardState => {\n        console.log(\"Карточка из стейта\", cardState);\n        console.log(\"Карточка c сервера\", newCard);\n        return cardState._id === newCard._id ? newCard : cardState;\n      });\n      setCards(newProducts);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      user: currentUser,\n      onUpdateUser: handleUpdateUser,\n      children: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Logo, {\n          className: \"logo logo_place_header\",\n          href: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Search, {\n          onSubmit: handleFormSubmit,\n          onInput: handleInputChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"content container\",\n      children: [/*#__PURE__*/_jsxDEV(SearchInfo, {\n        searchCount: cards.length,\n        searchText: searchQuery\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Sort, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content__cards\",\n        children: /*#__PURE__*/_jsxDEV(CardList, {\n          goods: cards,\n          onProductLike: handleProductLike,\n          currentUser: currentUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(App, \"Ge7QI8nC5VCblvmqcr6xrLucHtk=\", false, function () {\n  return [useDebounce];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useState","useEffect","CardList","Footer","Header","Logo","Search","Sort","SearchInfo","api","useDebounce","isLiked","App","cards","setCards","searchQuery","setSearchQuery","currentUser","setCurrentUser","debounceSearchQuery","handleRequest","search","then","searchResult","catch","err","console","log","Promise","all","getProductList","getUserInfo","productsData","userData","products","handleFormSubmit","e","preventDefault","handleInputChange","inputValue","handleUpdateUser","userUpdateData","setUserInfo","newUserData","handleProductLike","product","liked","likes","_id","changeLikeProduct","newCard","newProducts","map","cardState","length"],"sources":["/home/hercule/Documents/Courses/sber_university/projects/dogs_food/src/components/App/app.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport CardList from \"../CardList/card-list\";\nimport Footer from \"../Footer/footer\";\nimport Header from \"../Header/header\";\nimport Logo from \"../Logo/logo\";\nimport Search from \"../Search/search\";\nimport Sort from \"../Sort/sort\";\nimport \"./index.css\";\nimport SearchInfo from \"../SearchInfo\";\nimport api from \"../../utils/api\";\nimport useDebounce from \"../../hooks/useDebounce\";\nimport { isLiked } from \"../../utils/product\";\n\nfunction App() {\n  // устанавливаем состояния для карточек, поискового запроса\n  // и для пользователя\n  const [cards, setCards] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [currentUser, setCurrentUser] = useState(null);\n\n  // debounced версия поискового запроса\n  const debounceSearchQuery = useDebounce(searchQuery, 300);\n\n  // функция для совершения поисковых запросов с API для\n  // поиска продуктов\n  const handleRequest = () => {\n\n    api\n      .search(debounceSearchQuery)\n      .then((searchResult) => {\n\n        // обновляем карточки по результатам запроса\n        setCards(searchResult);\n      })\n      .catch((err) => console.log(err));\n  };\n\n  // Используем useEffect хук для загрузки списка продуктов и\n  // данных пользователя при загрузке компонента\n  useEffect(() => {\n    Promise.all([api.getProductList(), api.getUserInfo()])\n      .then(([productsData, userData]) => {\n          // обновляем состояние currentUser & cards\n        setCurrentUser(userData);\n        setCards(productsData.products);\n      })\n      .catch((err) => console.log(err));\n  }, []);\n\n  // Используем useEffect хук для вызова handleRequest при изменении\n  // поля поиска\n  useEffect(() => {\n    handleRequest();\n  }, [debounceSearchQuery]);\n\n  const handleFormSubmit = (e) => {\n    e.preventDefault();\n    handleRequest();\n  };\n\n  const handleInputChange = (inputValue) => {\n    setSearchQuery(inputValue);\n  };\n\n  function handleUpdateUser(userUpdateData) {\n    api.setUserInfo(userUpdateData).then((newUserData) => {\n      setCurrentUser(newUserData);\n    });\n  }\n\n  function handleProductLike(product) {\n    const liked = isLiked(product.likes, currentUser._id);\n    api.changeLikeProduct(product._id, liked).then((newCard) => {\n      const newProducts = cards.map((cardState) => {\n        console.log(\"Карточка из стейта\", cardState);\n        console.log(\"Карточка c сервера\", newCard);\n        return cardState._id === newCard._id ? newCard : cardState;\n      });\n\n      setCards(newProducts);\n    });\n  }\n\n  return (\n    <>\n      <Header user={currentUser} onUpdateUser={handleUpdateUser}>\n        <>\n          <Logo className=\"logo logo_place_header\" href=\"/\" />\n          <Search onSubmit={handleFormSubmit} onInput={handleInputChange} />\n        </>\n      </Header>\n      <main className=\"content container\">\n        <SearchInfo searchCount={cards.length} searchText={searchQuery} />\n        <Sort />\n        <div className=\"content__cards\">\n          <CardList\n            goods={cards}\n            onProductLike={handleProductLike}\n            currentUser={currentUser}\n          />\n        </div>\n      </main>\n      <Footer />\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}